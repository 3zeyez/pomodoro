<!DOCTYPE html>
<html>
<head>
    <title>Pomodoro Timer</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" sizes="">
    <link rel="shortcut icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="shortcut icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #ba4949;
            color: white;
            transition: background-color 0.5s ease;
        }

        .container {
            text-align: center;
            padding: 2rem;
            width: 100%;
            max-width: 600px;
        }

        .timer {
            font-size: 6rem;
            font-weight: bold;
            margin: 2rem 0;
        }

        .controls button {
            font-size: 1.2rem;
            margin: 0.5rem;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .controls button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .mode-buttons {
            margin-bottom: 2rem;
        }

        .mode-buttons button {
            font-size: 1rem;
            margin: 0 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
        }

        .mode-buttons button.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        #task-name {
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        /* Task List Styles */
        .task-section {
            margin-top: 2rem;
            width: 100%;
            text-align: left;
        }

        .task-input-container {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        #task-input {
            flex: 1;
            padding: 0.8rem;
            font-size: 1rem;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        #task-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        #add-task-btn {
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
        }

        .task-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            gap: 0.5rem;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .task-text {
            flex: 1;
            margin: 0 0.5rem;
        }

        .task-item.completed .task-text {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .delete-task-btn {
            padding: 0.4rem 0.8rem;
            font-size: 0.9rem;
            border: none;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="mode-buttons">
            <button onclick="setMode('pomodoro')" class="active">Pomodoro</button>
            <button onclick="setMode('shortBreak')">Short Break</button>
            <button onclick="setMode('longBreak')">Long Break</button>
        </div>

        <div id="task-name">Time to focus!</div>
        <div class="timer" id="timer">25:00</div>

        <div class="controls">
            <button onclick="startTimer()" id="start-btn">START</button>
            <button onclick="resetTimer()">RESET</button>
        </div>

        <div class="task-section">
            <div class="task-input-container">
                <input type="text" id="task-input" placeholder="What are you working on?" maxlength="50">
                <button id="add-task-btn" onclick="addTask()">Add Task</button>
            </div>
            <ul class="task-list" id="task-list"></ul>
        </div>
    </div>

    <script>
        const modes = {
            pomodoro: { minutes: 25, backgroundColor: '#ba4949' },
            shortBreak: { minutes: 5, backgroundColor: '#38858a' },
            longBreak: { minutes: 15, backgroundColor: '#397097' }
        };

        let timeLeft;
        let currentMode = 'pomodoro';
        let timerInterval = null;
        let isRunning = false;
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

        // Initialize tasks from localStorage
        function initTasks() {
            renderTasks();
            
            // Add enter key listener for task input
            document.getElementById('task-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTask();
                }
            });
        }

        function addTask() {
            const input = document.getElementById('task-input');
            const taskText = input.value.trim();
            
            if (taskText) {
                const task = {
                    id: Date.now(),
                    text: taskText,
                    completed: false
                };
                
                tasks.push(task);
                saveTasks();
                renderTasks();
                input.value = '';
            }
        }

        function toggleTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveTasks();
                renderTasks();
            }
        }

        function deleteTask(taskId) {
            tasks = tasks.filter(t => t.id !== taskId);
            saveTasks();
            renderTasks();
        }

        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function renderTasks() {
            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';
            
            tasks.forEach(task => {
                const li = document.createElement('li');
                li.className = `task-item ${task.completed ? 'completed' : ''}`;
                
                li.innerHTML = `
                    <input type="checkbox" class="task-checkbox" 
                           ${task.completed ? 'checked' : ''} 
                           onclick="toggleTask(${task.id})">
                    <span class="task-text">${task.text}</span>
                    <button class="delete-task-btn" onclick="deleteTask(${task.id})">Delete</button>
                `;
                
                taskList.appendChild(li);
            });
        }

        function setMode(mode) {
            // Reset active state for all buttons
            document.querySelectorAll('.mode-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Set active state for clicked button
            event.target.classList.add('active');

            currentMode = mode;
            document.body.style.backgroundColor = modes[mode].backgroundColor;
            
            // Update task name
            const taskName = mode === 'pomodoro' ? 'Time to focus!' : 'Time for a break!';
            document.getElementById('task-name').textContent = taskName;

            resetTimer();
        }

        function updateDisplay(minutes, seconds) {
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer').textContent = display;
        }

        function startTimer() {
            if (isRunning) {
                clearInterval(timerInterval);
                document.getElementById('start-btn').textContent = 'START';
                isRunning = false;
                return;
            }

            isRunning = true;
            document.getElementById('start-btn').textContent = 'PAUSE';

            if (!timeLeft) {
                timeLeft = modes[currentMode].minutes * 60;
            }

            timerInterval = setInterval(() => {
                timeLeft--;

                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;

                updateDisplay(minutes, seconds);

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    playAlarm();
                    resetTimer();
                    isRunning = false;
                    document.getElementById('start-btn').textContent = 'START';
                }
            }, 1000);
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timeLeft = modes[currentMode].minutes * 60;
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            updateDisplay(minutes, seconds);
            document.getElementById('start-btn').textContent = 'START';
            isRunning = false;
        }

        function playAlarm() {
            // Create and play a simple beep sound
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            oscillator.connect(audioContext.destination);
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Initialize timer and tasks
        resetTimer();
        initTasks();
    </script>
</body>
</html>